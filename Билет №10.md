 Кубические сплайны. Алгоритм построения через вторые производные (моменты).![[Pasted image 20251224160025.png]]
 ![[Pasted image 20251224160039.png]]
 # Билет №10: Кубические сплайны. Алгоритм построения

**Содержание:**
1. Постановка условий сшивки.
2. Выражение коэффициентов через вторые производные ($c_i$).
3. Получение системы уравнений относительно $c_i$.
4. Трехдиагональная матрица (СЛАУ).

---

### 1. Постановка задачи и условия

Пусть даны точки $x_i, \, i=\overline{1,n}$.
Рассмотрим кубический полином на отрезке $[x_{i-1}, x_i]$:
```math
P_i(x) = d_i(x-x_{i-1})^3 + c_i(x-x_{i-1})^2 + b_i(x-x_{i-1}) + a_i, \quad i=\overline{2, n}
```

Условия интерполяции и гладкости:
1.  $P_i(x_{i-1}) = y_{i-1}$
2.  $P_i(x_i) = y_i$
3.  $P'_i(x_i) = P'_{i+1}(x_i)$ (непрерывность 1-й производной)
4.  $P''_i(x_i) = P''_{i+1}(x_i)$ (непрерывность 2-й производной)

Всего, если $n$ точек, то между ними $n-1$ промежуток.
Неизвестных коэффициентов ($d_i, c_i, b_i, a_i$) — $4(n-1)$.

---

### 2. Выражение коэффициентов через вторые производные

Обозначим $P''_i(x) = 2c_i$ (в локальных координатах, но здесь используется другой подход — через моменты в узлах).
Введем обозначение $c_i$ как параметры, связанные со второй производной.
Обозначим $h_i = x_i - x_{i-1}$.

**Из условий непрерывности второй производной:**
```math
P''_i(x) = 6d_i(x-x_{i-1}) + 2c_i
```
В точке $x_i$ (стык правого конца текущего и левого конца следующего):
```math
6d_i h_i + 2c_i = 2c_{i+1}
```
Отсюда выражаем коэффициент $d_i$:
```math
d_i = \frac{c_{i+1} - c_i}{3h_i}
```
*(Здесь $2c_i$ — это значение второй производной в узле $x_{i-1}$, $2c_{i+1}$ — в узле $x_i$)*.

**Граничные условия (естественный сплайн):**
Вторая производная на краях равна нулю.
```math
2c_2 = \sigma_1, \quad 2c_{n+1} = \sigma_2
```
Если $\sigma_1 = \sigma_2 = 0$, то сплайн с естественными граничными условиями.
Введем фиктивную переменную $c_{n+1}$ (для удобства записи).

**Выражение остальных коэффициентов:**
Из условия $P_i(x_{i-1}) = y_{i-1}$ следует:
```math
a_i = y_{i-1}
```

Из условия $P_i(x_i) = y_i$:
```math
d_i h_i^3 + c_i h_i^2 + b_i h_i + a_i = y_i
```
Подставим найденные $a_i$ и $d_i$:
```math
\frac{c_{i+1} - c_i}{3h_i} h_i^3 + c_i h_i^2 + b_i h_i = y_i - y_{i-1}
```
Выражаем $b_i$:
```math
b_i = \frac{y_i - y_{i-1}}{h_i} - \frac{2c_i h_i + c_{i+1} h_i}{3}
```

**Итог:** Если мы знаем параметры $c_i$, то мы знаем все коэффициенты $a_i, b_i, d_i$.

---

### 3. Получение системы для $c_i$

Используем условие непрерывности первой производной:
```math
P'_i(x_i) = P'_{i+1}(x_i)
```

Производная на левом интервале $P'_i(x) = 3d_i(x-x_{i-1})^2 + 2c_i(x-x_{i-1}) + b_i$.
В точке $x_i$:
```math
P'_i(x_i) = 3d_i h_i^2 + 2c_i h_i + b_i
```
Подставим выражения для $d_i, b_i$ и упростим:
```math
(c_{i+1} - c_i)h_i + 2c_i h_i + b_i = b_{i+1}
```
*(Здесь $b_{i+1}$ — свободный член производной следующего полинома в точке $x_i$)*.

Подставляем развернутые формулы для $b_i$ и $b_{i+1}$:
```math
(c_{i+1} + c_i)h_i = \underbrace{\left( \frac{y_{i+1}-y_i}{h_{i+1}} - \frac{y_i-y_{i-1}}{h_i} \right)}_{A} - \frac{2c_{i+1}h_{i+1} + c_{i+2}h_{i+1}}{3} + \frac{2c_i h_i + c_{i+1}h_i}{3}
```

После группировки слагаемых получаем уравнение относительно трех соседних неизвестных ($c_i, c_{i+1}, c_{i+2}$):

```math
h_i c_i + 2(h_i + h_{i+1})c_{i+1} + h_{i+1}c_{i+2} = 3 \left( \frac{y_{i+1}-y_i}{h_{i+1}} - \frac{y_i-y_{i-1}}{h_i} \right)
```

Это уравнение записывается для всех внутренних узлов $i = \overline{2, n-1}$.

---

### 4. Структура СЛАУ

Полученная система линейных уравнений имеет **трехдиагональную матрицу**.
Такие системы эффективно решаются методом прогонки.
Неизвестные здесь — коэффициенты $c_i$ (связанные со вторыми производными в узлах).