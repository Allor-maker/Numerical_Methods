Оценка погрешности интерполяции. Вывод формулы остаточного члена для функции класса Cn (через производную n-го порядка и вспомогательную функцию).
![[Pasted image 20251224153525.png]]
![[Pasted image 20251224153544.png]]
![[Pasted image 20251224153557.png]]
![[Pasted image 20251224153651.png]]
![[Pasted image 20251224153655.png]]
# Билет №5: Оценка погрешности интерполяции

**Содержание:**
1. Постановка задачи.
2. Ввод вспомогательной функции.
3. Применение теоремы Ролля (вывод остаточного члена).
4. Оценка для равноотстоящих узлов (частный случай).

---

### 1. Постановка задачи

Пусть задана функция $f(x)$ и для точек $(x_i, f(x_i))$ построен интерполяционный полином $P_{n-1}(x)$.
Возникает вопрос: **какой константой можно ограничить разницу (ошибку приближения) $|f(x) - P_{n-1}(x)|$?**

**Предположения:**
1. $f(x) \in C^n[a, b]$ (функция $n$ раз дифференцируема на отрезке).
2. Обозначим $\omega(x) = \prod_{j=1}^n (x - x_j)$.
3. Обозначим $e(x) = f(x) - P_{n-1}(x)$ — ошибка приближения.

---

### 2. Вывод формулы остаточного члена

Введем вспомогательную функцию $\varphi(t)$ (где $x$ — фиксировано, переменная $t$):
```math
\varphi(t) = \omega(x) \cdot e(t) - \omega(t) \cdot e(x)
```
Здесь $x$ — точка, в которой мы хотим найти ошибку $|e(x)|$. Будем считать, что $x \in [x_1, x_n]$.

**Анализ корней $\varphi(t)$:**
Найдем точки, где $\varphi(t) = 0$:
1. В узлах интерполяции $t = x_i$: $e(x_i) = 0$ и $\omega(x_i) = 0 \Rightarrow \varphi(x_i) = 0$. (Всего $n$ точек).
2. В точке $t = x$: $\varphi(x) = \omega(x)e(x) - \omega(x)e(x) = 0$. (1 точка).
**Итого:** $\varphi(t)$ имеет $n+1$ корень на отрезке $[a, b]$.

**Применим теорему Ролля:**
> Если функция непрерывна на $[a, b]$, дифференцируема на $(a, b)$ и $f(a)=f(b)$, то $\exists \xi \in (a, b): f'(\xi)=0$.

*   $\varphi(t)$ имеет $n+1$ корень $\Rightarrow \varphi'(t)$ имеет не менее $n$ корней.
*   $\varphi'(t)$ имеет $n$ корней $\Rightarrow \varphi''(t)$ имеет не менее $n-1$ корень.
*   ...
*   $\Rightarrow \varphi^{(n)}(t)$ имеет не менее **1 корня**.

Обозначим этот корень $\xi \in (a, b)$, то есть $\varphi^{(n)}(\xi) = 0$.

**Дифференцируем $\varphi(t)$ $n$ раз по $t$:**
```math
\varphi(t) = \omega(x) \cdot e(t) - e(x) \cdot \omega(t)
```
(Помним, что $\omega(x)$ и $e(x)$ — константы относительно $t$).

1.  Производная первого слагаемого: $\omega(x) \cdot e^{(n)}(t)$.
    Так как $e(t) = f(t) - P_{n-1}(t)$, а $P_{n-1}(t)$ — полином степени $n-1$, то его $n$-я производная равна 0.
    $\Rightarrow e^{(n)}(t) = f^{(n)}(t)$.
2.  Производная второго слагаемого: $e(x) \cdot \omega^{(n)}(t)$.
    $\omega(t) = t^n + \dots$ (старшая степень $t^n$ с коэффициентом 1).
    $\Rightarrow \omega^{(n)}(t) = n!$.

Получаем:
```math
\varphi^{(n)}(t) = \omega(x) \cdot f^{(n)}(t) - e(x) \cdot n!
```

В точке $t = \xi$ имеем $\varphi^{(n)}(\xi) = 0$:
```math
0 = \omega(x) \cdot f^{(n)}(\xi) - e(x) \cdot n!
```
```math
e(x) \cdot n! = \omega(x) \cdot f^{(n)}(\xi)
```

**Итоговая формула погрешности:**
```math
|e(x)| = \frac{|f^{(n)}(\xi)| \cdot |\omega(x)|}{n!}
```
Или оценка сверху:
```math
|f(x) - P_{n-1}(x)| \le \frac{M_n}{n!} |\omega(x)|, \quad \text{где } M_n = \max_{x \in [a, b]} |f^{(n)}(x)|
```

---

### 3. Частный случай (Равноотстоящие узлы)

Оценим $|\omega(x)| = |(x-x_1)\dots(x-x_n)|$.
Пусть $x_{i+1} - x_i = h$ (шаг фиксирован).
Рассматриваем интервал между первыми двумя узлами (для оценки максимума). Пусть $x \in (x_1, x_2)$, тогда $x = x_1 + \alpha$, где $0 < \alpha < h$.
Введем вспомогательную функцию для оценки двух соседних скобок: $g(x) = (x-a)(a+h-x)$.
$g'(x) = 0$ при $x = a + \frac{h}{2}$ (середина).
$\Rightarrow \max g(x) = \frac{h}{2} \cdot \frac{h}{2} = \frac{h^2}{4}$.

Остальные скобки можно оценить грубо через шаг $h$:
```math
|x-x_3| \approx 2h, \dots, |x-x_n| \approx (n-1)h
```

Тогда оценка произведения:
```math
|\omega(x)| \le \underbrace{\frac{h^2}{4}}_{\text{первые 2 члена}} \cdot \underbrace{(n-1)! h^{n-2} \cdot h}_{\text{остальные}} \approx \frac{h^2}{4} (n-1)! h^{n-1}
```
*(Примечание переводчика: в записях небольшая путаница со степенями, но логика следующая: два члена дают $h^2/4$, остальные $(n-2)$ членов дают факториал).*

Подставляем в формулу ошибки:
```math
|e(x)| \le \frac{M_n}{n!} \cdot \frac{h^2}{4} (n-1)! h^{n-1}
```
```math
|e(x)| \le \frac{M_n (n-1)! h^{n+1}}{(n-1)! n \cdot 4}
```

**Итоговая оценка (как в тетради, но см. анализ ниже):**
```math
|f(x) - P_{n-1}(x)| \le \frac{M_n h^{n+1}}{n}
```
