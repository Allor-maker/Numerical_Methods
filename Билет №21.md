Квадратурные формулы Гаусса. Идея метода (максимизация АСТ за счет выбора узлов), отличие от формул Ньютона-Котеса. Использование ортогональных многочленов Лежандра.![[Pasted image 20251224161405.png]]
![[Pasted image 20251224161415.png]]
![[Pasted image 20251224161426.png]]
# Билет №21: Квадратурные формулы Гаусса

## 1. Определение и формулы (из конспекта 1)

**Формулами Гаусса** называются интерполяционные квадратурные формулы, имеющие **максимальную алгебраическую степень** для данного числа узлов.

Формула Гаусса с $K$ узлами имеет степень $2K-1$ и порядок $2K$. Формулы Гаусса обычно приводят для стандартного отрезка $[-1, 1]$:

| Число узлов, $K$ | Узлы $x_k$ | Веса $w_k$ | $E[f]$ (Ошибка) |
| :---: | :---: | :---: | :---: |
| 1 | $0$ | $1$ | $\frac{f''(\xi)(b-a)^3}{24}$ |
| 2 | $\pm \frac{1}{\sqrt{3}}$ | $\frac{1}{2}$ | $\frac{f^{(IV)}(\xi)(b-a)^5}{4320}$ |
| 3 | $0$ <br> $\pm \sqrt{\frac{3}{5}}$ | $\frac{4}{9}$ <br> $\frac{5}{18}$ | $\frac{f^{(VI)}(\xi)(b-a)^7}{2016000}$ |

> *Примечание: в таблице приведены веса, нормированные для единичной длины или специфичного определения, так как для классического отрезка $[-1,1]$ сумма весов равна 2.*

**Простейшая формула Гаусса** совпадает с формулой средней точки.
Узлы формул Гаусса не содержат крайних точек отрезка интегрирования.

Построенный многочлен:
```math
\omega(x) = C_{S+1} L_{S+1}\left(\frac{2x-a-b}{b-a}\right),
```
где $C_{S+1}$ — некоторый несущественный нормировочный множитель.

Использование в качестве узлов квадратурной формулы **корней многочлена Лежандра** позволяет добиться обнуления всех интегралов:
```math
\int_a^b V(x)\omega(x)dx
```
при $\deg V(x) \le S$, то есть повысить степень квадратуры до $2S+1$, то есть почти вдвое по сравнению с формулами с произвольным выбором узлов.

Для $\deg V(x) = S+1$ никакой выбор узлов не обеспечит обнуления интеграла (достаточно взять $V(x)=\omega(x)$).

$\Rightarrow$ **MAX степень квадратуры с $S+1$ узлом — $2S+1$.**

---

## 2. Условия повышения степени (из конспекта 3)

Пусть $I[f] = \sum_{k=0}^S w_k f(x_k)$ — интерполяционная квадратурная формула.
Рассмотрим произвольный многочлен $P(x)$, степени выше $S$.
Разделим его с остатком на многочлен $\omega(x) = \prod_{k=0}^S (x-x_k)$:
```math
P(x) = V(x) \cdot \omega(x) + Z(x).
```

Многочлен $Z(x)$ имеет степень не выше $S$, и, следовательно, интегрируется точно $E[Z]=0$.
Тогда ошибка интегрирования $P(x)$ составляет:
```math
E[P] = E[V \cdot \omega] = \int_a^b V(x)\omega(x)dx - I[V \cdot \omega]
```
Т.к. $I[V \cdot \omega]$ обнуляется во всех узлах $x_k$, получаем:
```math
E[P] = \int_a^b V(x)\omega(x)dx
```

Для многочлена $P(x) = V(x)\omega(x) + Z(x)$ ошибка квадратурной формулы составляет $E[P] = \int_a^b V(x)\omega(x)dx$.

**Например, для формулы Симпсона** последний интеграл обнуляется, если $V(x) = V - \text{константа}$:
```math
\int_a^b V(x)(x-a)(x-b)\left(x - \frac{a+b}{2}\right)dx = V \int_a^b (x-a)(x-b)\left(x - \frac{a+b}{2}\right)dx = 0
```
Формула Симпсона будет точной для всех многочленов, которые при делении на $\omega(x)$ дают в частном константу, то есть для всех многочленов степени $S+1$.

Причина повышения порядка формулы Симпсона — в удачном расположении узлов квадратуры.

**Задача (постановка):**
Разместить узлы $x_k, k=0,\dots,S$ квадратуры так, чтобы интеграл
```math
\int_a^b V(x) \cdot \omega(x) dx
```
обнулялся для произвольного многочлена $V(x)$ как можно большей степени $d$.

---

## 3. Ортогональные многочлены и Лежандр (из конспекта 2)

Если удастся так расположить узлы квадратуры, то она будет иметь алгебраический порядок $m=s+d+1$.

### Ортогональные многочлены
Построим такой многочлен $\omega(x)$, который был бы ортогонален многочленам $1, x, \dots, x^S$ в смысле:
```math
(x^r, \omega(x)) \equiv \int_a^b x^r \cdot \omega(x) dx = 0, \quad \text{где } r=0,\dots,S.
```

Для построения такого многочлена $\omega(x)$ можно использовать процесс ортогонализации Грама-Шмидта для набора функций $1, x, \dots, x^{S+1}$.
В результате ортогонализации из многочлена $x^{S+1}$ получится многочлен $\omega(x) = x^{S+1} + \dots$, ортогональный всем функциям $1, x, \dots, x^S$, а следовательно, и любому многочлену $V(x)$ степени $\deg V \le S$.

### Многочлены Лежандра $L_m(x)$
Ортогональны на $[-1, 1]$:
```math
\int_{-1}^1 L_m(x) \cdot L_n(x) dx = \frac{2}{n+1} \cdot \delta_{nm}
```

Рассмотрим дифференциальное уравнение:
```math
(1-x^2)\frac{d^2 u}{dx^2} - 2x\frac{du}{dx} + n(n+1)u = 0
```
Решения этого уравнения при целых $n$ представляются в виде:
```math
L_n(x) = \frac{1}{2^n n!} \frac{d^n}{dx^n}((x^2-1)^n)
```
*(Формула Родрига, в конспекте названа рекуррентной формулой)*.

**Свойства полиномов Лежандра:**
1. Если $n \neq 0$, то $\forall x \in (-1, 1), |L_n(x)| < 1$.
2. Если $n \neq 0$, то степень $L_n(x)$ равна $n$.
3. Сумма коэффициентов многочлена Лежандра равна 1 (свойство нормировки, $L_n(1)=1$).
4. Уравнение $L_n(x)=0$ имеет ровно $n$ различных корней на отрезке $x \in [-1, 1]$.
5. Если $n$ — чётное, то полином $L_n(x)$ — чётная функция, а если $n$ — нечётное, то полином $L_n(x)$ — нечётная функция.