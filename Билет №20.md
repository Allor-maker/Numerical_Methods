Правило Рунге. Апостериорная оценка погрешности (метод двойного пересчета на сетках с шагом h и h 2), контроль фактического порядка сходимости.![[Pasted image 20251224161317.png]]
![[Pasted image 20251224161345.png]]
# Билет №20: Правило Рунге (Апостериорная оценка погрешности)

**Содержание:**
1. Понятие апостериорной оценки.
2. Вывод формулы Рунге.
3. Контроль порядка сходимости.

---

### 1. Введение: Априорные и апостериорные оценки

*   Построенные ранее формулы для остаточного члена (типа $M_n h^k$) являются **априорными**. На практике оценить максимум нужной производной бывает сложно или вообще невозможно (например, если функция $f(x)$ задана как "чёрный ящик" или таблично).
*   Широкое распространение получили способы оценить ошибку прямо в процессе вычислений, используя результаты на разных сетках. Такие оценки называются **апостериорными**.

---

### 2. Правило Рунге (Метод двойного пересчета)

Пусть $I^*$ — точное значение интеграла.
Пусть $I_h$ — приближенное значение, вычисляемое на сетке с шагом $h$ по квадратурной формуле порядка $p$ (то есть ошибка $O(h^p)$).

Запишем разложение ошибки:
```math
I^* = I_h + E[f] = I_h + c \cdot h^p + o(h^p)
```
где $c \cdot h^p$ — главный член погрешности ($\mathcal{E}_h$). Константа $c$ зависит от производных функции, но не от шага $h$.

Вычислим интеграл дважды: на сетке с шагом $h$ и на сгущенной сетке с шагом $h/2$:
1.  $I^* = I_h + c \cdot h^p + o(h^p)$
2.  $I^* = I_{h/2} + c \cdot (h/2)^p + o(h^p) = I_{h/2} + \frac{c \cdot h^p}{2^p} + o(h^p)$

Обозначим главный член ошибки на мелкой сетке как $\mathcal{E}_{h/2} = c (h/2)^p$.
Тогда ошибка на крупной сетке: $\mathcal{E}_h = c h^p = 2^p \cdot \mathcal{E}_{h/2}$.

Рассмотрим разность приближенных значений (которую мы можем вычислить):
```math
\Delta_{h/2} \equiv I_{h/2} - I_h = (I^* - \mathcal{E}_{h/2}) - (I^* - \mathcal{E}_h) = \mathcal{E}_h - \mathcal{E}_{h/2}
```
Подставим связь ошибок:
```math
\Delta_{h/2} = 2^p \mathcal{E}_{h/2} - \mathcal{E}_{h/2} = (2^p - 1) \mathcal{E}_{h/2}
```

Отсюда выражаем главный член погрешности на мелкой сетке:
```math
\mathcal{E}_{h/2} \approx \frac{I_{h/2} - I_h}{2^p - 1}
```

Это и есть **Правило Рунге**. Оно позволяет оценить погрешность, зная только два приближенных ответа и теоретический порядок метода $p$.

**Уточненное решение (Экстраполяция Ричардсона):**
Можно получить более точное значение, добавив поправку:
```math
I_{ym} = I_{h/2} + \frac{I_{h/2} - I_h}{2^p - 1}
```
Оно имеет порядок точности $p+1$ (или выше).

---

### 3. Контроль порядка сходимости

Использование правила Рунге требует осторожности. Требуется контролировать, что **фактический порядок сходимости** численного метода соответствует номинальному (теоретическому) $p$.

Фактический порядок $p^*$ может быть меньше номинального в силу некоторых обстоятельств (например, недостаточная гладкость функции $f(x)$ или особенности на границах).

**Способ контроля:**
Вычисляем интеграл на трех сетках: $h, h/2, h/4$.
Находим разности:
*   $\Delta_h = I_{h/2} - I_h \approx \mathcal{E}_h - \mathcal{E}_{h/2}$
*   $\Delta_{h/2} = I_{h/4} - I_{h/2} \approx \mathcal{E}_{h/2} - \mathcal{E}_{h/4}$

Так как $\mathcal{E}_h \approx 2^p \mathcal{E}_{h/2}$, то отношение разностей должно быть близко к $2^p$:
```math
\frac{\Delta_h}{\Delta_{h/2}} \approx \frac{(2^p-1)\mathcal{E}_{h/2}}{(2^p-1)\mathcal{E}_{h/4}} \approx 2^p
```

Отсюда можно выразить экспериментальный порядок сходимости:
```math
p^* \equiv \log_2 \left| \frac{I_{h/2} - I_h}{I_{h/4} - I_{h/2}} \right| \approx p
```

Если $p^*$ сильно отличается от теоретического $p$, то правилу Рунге доверять нельзя (нужно уменьшать шаг или искать ошибку).