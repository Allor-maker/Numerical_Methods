Погрешность численного интегрирования. Вывод остаточных членов квадратурных формул методом дифференцирования по параметру (на примере формулы средней точки, трапеций или Симпсона).![[Pasted image 20251224161210.png]]
![[Pasted image 20251224161224.png]]
![[Pasted image 20251224161235.png]]
![[Pasted image 20251224161246.png]]
![[Pasted image 20251224161256.png]]
# Билет №19: Погрешность численного интегрирования (Метод дифференцирования по параметру)

**Содержание:**
1. Метод дифференцирования по параметру (общая идея).
2. Вывод погрешности для формулы средней точки.
3. Вывод погрешности для формулы трапеций.
4. Вывод погрешности для формулы Симпсона.

---

### 1. Вывод для формулы средней точки (прямоугольников)

**Точное значение:** $I = \int_a^b f(x) dx$.
**Приближенное значение:** $I_{\text{ср.т.}} = f(\frac{a+b}{2}) \cdot (b-a)$.

Введем параметр $h = \frac{b-a}{2}$ (полудлина) и центр отрезка $\theta = \frac{a+b}{2}$.
Тогда $a = \theta - h$, $b = \theta + h$.
Погрешность $R(h)$ как функция от $h$:
$$ R(h) = \int_{\theta-h}^{\theta+h} f(t) dt - 2h \cdot f(\theta) $$
Очевидно, что $R(0) = 0$.

**Дифференцируем по $h$:**
Используем формулу Лейбница дифференцирования интеграла с переменным верхним пределом.
$$ R'_h = (F(\theta+h) - F(\theta-h))'_h - 2f(\theta) $$
(где $F(x)$ — первообразная для $f(x)$).
$$ R'_h = f(\theta+h) \cdot 1 - f(\theta-h) \cdot (-1) - 2f(\theta) = f(\theta+h) + f(\theta-h) - 2f(\theta) $$
Причем $R'(0) = f(\theta) + f(\theta) - 2f(\theta) = 0$.

**Вторая производная:**
$$ R''_h = f'(\theta+h) - f'(\theta-h) $$
Применим теорему Лагранжа для разности производных:
$$ f'(\theta+h) - f'(\theta-h) = f''(\xi) \cdot (\theta+h - (\theta-h)) = f''(\xi) \cdot 2h $$
$$ R''_h = f''(\xi) \cdot 2h $$

**Интегрируем обратно:**
1. $R'_h = \int_0^h f''(\xi) \cdot 2t \, dt \approx f''(\xi) \cdot h^2 + C_1$. (Так как $R'(0)=0$, то $C_1=0$).
2. $R(h) = \int_0^h f''(\xi) \cdot t^2 \, dt \approx f''(\xi) \cdot \frac{h^3}{3}$.

Подставим $h = \frac{b-a}{2}$:
$$ R = f''(\xi) \frac{(b-a)^3}{8 \cdot 3} = \frac{f''(\xi)(b-a)^3}{24} $$

**Итог:**
$$ \boxed{|R| \le \frac{M_2 (b-a)^3}{24}} $$

---

### 2. Вывод для формулы трапеций

$$ I_{\text{тр}} = \frac{f(a)+f(b)}{2} (b-a) $$
Вводим $\theta, h$ так же.
$$ R(h) = \int_{\theta-h}^{\theta+h} f(t) dt - h (f(\theta-h) + f(\theta+h)) $$
$R(0) = 0$.

**Первая производная:**
$$ R'_h = (f(\theta+h) + f(\theta-h)) - \left[ 1 \cdot (f(\theta-h) + f(\theta+h)) + h(-f'(\theta-h) + f'(\theta+h)) \right] $$
Слагаемые с самими функциями сокращаются:
$$ R'_h = -h (f'(\theta+h) - f'(\theta-h)) $$
По теореме Лагранжа: $f'(\theta+h) - f'(\theta-h) \approx f''(\xi) \cdot 2h$.
$$ R'_h \approx -h \cdot 2h \cdot f''(\xi) = -2h^2 f''(\xi) $$

**Интегрируем:**
$$ R(h) = \int -2t^2 f''(\xi) dt = - \frac{2h^3}{3} f''(\xi) $$
Подставляем $h = \frac{b-a}{2}$:
$$ R = -f''(\xi) \frac{2}{3} \frac{(b-a)^3}{8} = -\frac{f''(\xi)(b-a)^3}{12} $$

**Итог:**
$$ \boxed{|R| \le \frac{M_2 (b-a)^3}{12}} $$

---

### 3. Вывод для формулы Симпсона

$$ R(h) = \int_{\theta-h}^{\theta+h} f(t) dt - \frac{h}{3} (f(\theta-h) + 4f(\theta) + f(\theta+h)) $$
(Здесь длина отрезка $2h$, поэтому шаг формулы Симпсона равен $h$. В стандартной записи $(b-a)/6$ это соответствует $2h/6 = h/3$).

**Производные:**
1. $R'_h = \dots$ (после сокращений) $= \frac{2}{3}f(\theta+h) + \frac{2}{3}f(\theta-h) - \frac{4}{3}f(\theta) - \frac{h}{3}(f'(\theta+h) - f'(\theta-h))$.
   $R'(0) = 0$.
2. $R''_h = \dots = \frac{1}{3}(f'(\theta+h) - f'(\theta-h)) - \frac{h}{3}(f''(\theta+h) + f''(\theta-h))$.
   $R''(0) = 0$.
3. $R'''_h = -\frac{h}{3}(f'''(\theta+h) - f'''(\theta-h))$.

По теореме Лагранжа: $f'''(\theta+h) - f'''(\theta-h) = f^{IV}(\xi) \cdot 2h$.
$$ R'''_h = -\frac{h}{3} \cdot 2h \cdot f^{IV}(\xi) = -\frac{2}{3}h^2 f^{IV}(\xi) $$

**Интегрируем 3 раза:**
1. $R''_h = -\frac{2}{9}h^3 f^{IV}(\xi)$
2. $R'_h = -\frac{2}{36}h^4 f^{IV}(\xi) = -\frac{1}{18}h^4 f^{IV}(\xi)$
3. $R(h) = -\frac{1}{90}h^5 f^{IV}(\xi)$

Подставляем $h = \frac{b-a}{2}$:
$$ R = -f^{IV}(\xi) \frac{1}{90} \frac{(b-a)^5}{32} = -\frac{f^{IV}(\xi)(b-a)^5}{2880} $$

**Итог:**
$$ \boxed{|R| \le \frac{M_4 (b-a)^5}{2880}} $$
